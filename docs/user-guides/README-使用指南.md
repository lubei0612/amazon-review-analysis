# 🚀 Amazon评论分析系统 - 使用指南

## 📋 系统说明

本系统提供 **Chrome 插件** 方式分析 Amazon 产品评论，通过 AI 生成 6 维度深度分析报告。

### 🎯 主要使用方式

**Chrome 插件 + 后端服务** （推荐）

```
用户 → Amazon产品页 → 点击插件 → 后端分析 → 显示报告
```

### 🎨 可选方式

**Web 界面** （演示/开发用）

```
用户 → 输入ASIN → 后端分析 → 显示报告
```

---

## ⚙️ 第一步：环境配置

### 1. 创建 `.env` 配置文件

复制 `env.example` 为 `.env`：

```bash
copy env.example .env
```

### 2. 填写 API 密钥

编辑 `.env` 文件：

```env
# Gemini API Key (必填) - AI 分析引擎
GEMINI_API_KEY=你的Gemini密钥

# RapidAPI Key (必填) - 评论爬虫
RAPIDAPI_KEY=你的RapidAPI密钥
RAPIDAPI_HOST=real-time-amazon-data.p.rapidapi.com
```

### 3. 获取 API 密钥

#### 🤖 Gemini API Key

1. 访问：https://aistudio.google.com/app/apikey
2. 登录 Google 账号
3. 点击「Create API Key」
4. 复制密钥（格式：`AIzaSy...` 或通过代理 `sk-...`）

#### 🕷️ RapidAPI Key

1. 访问：https://rapidapi.com/letscrape-6bRBa3QguO5/api/real-time-amazon-data
2. 注册并登录
3. 订阅免费套餐（500次/月）
4. 复制 API Key

---

## 🚀 第二步：启动后端服务

### 方式1：一键启动（推荐）

双击运行：**`START.bat`**

选择 **[1] 标准模式** - 启动后端API

### 方式2：快速启动

双击运行：**`START-BACKEND.bat`**

### 验证服务已启动

访问：http://localhost:3001/api/health

正常响应：
```json
{
  "status": "ok",
  "services": {
    "rapidapi": "available",
    "gemini": "available"
  }
}
```

---

## 🔧 第三步：安装 Chrome 插件

### 1. 打开 Chrome 扩展管理页面

在地址栏输入：
```
chrome://extensions/
```

### 2. 开启开发者模式

点击页面右上角的 **「开发者模式」** 开关

### 3. 加载扩展

1. 点击 **「加载已解压的扩展程序」**
2. 选择项目目录中的 **`chrome-extension`** 文件夹
3. 点击「选择文件夹」

### 4. 验证安装

扩展列表中会出现 **「Amazon评论分析」** 插件

---

## 🎯 第四步：配置插件 API Key

### 1. 点击插件图标

在 Chrome 工具栏找到插件图标并点击

### 2. 打开设置面板

点击插件弹窗中的 **「⚙️ 设置」** 按钮

### 3. 配置 API Key

1. AI Provider：保持默认 **Gemini 2.5 Pro**
2. API Key：输入您的 Gemini API Key
3. 点击 **「💾 保存设置」**

### 4. 测试连接（可选）

点击 **「🔍 测试连接」** 按钮，确认配置成功

---

## 🌟 第五步：开始分析

### 1. 访问 Amazon 产品页面

打开任意 Amazon 产品页面，例如：
```
https://www.amazon.com/dp/B07ZPKN6YR
```

### 2. 点击插件图标

在 Chrome 工具栏点击 **「Amazon评论分析」** 插件图标

### 3. 开始分析

在弹出窗口中点击 **「🚀 开始分析」** 按钮

### 4. 等待分析完成

插件会显示进度：
- 📥 正在爬取评论...
- 🤖 正在AI分析...
- ✅ 分析完成！

### 5. 查看报告

分析完成后，页面会自动跳转显示：

#### 📊 6 维度分析报告

1. **👥 消费者画像** - 用户群体特征分析
2. **🎯 使用场景** - 产品使用场景分类
3. **⭐ 星级影响度** - 评分分布与关键因素
4. **💎 产品优势** - 用户好评要点
5. **⚠️ 产品缺陷** - 用户差评要点
6. **💰 购买动机** - 用户购买原因
7. **🔍 未满足需求** - 改进建议

---

## 🔄 完整使用流程图

```
┌─────────────────────────────────────────────────────────┐
│  第1步: 配置 .env 文件                                   │
│         - GEMINI_API_KEY                                │
│         - RAPIDAPI_KEY                                  │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│  第2步: 启动后端服务                                     │
│         双击: START.bat → [1] 标准模式                   │
│         或直接双击: START-BACKEND.bat                    │
│         服务地址: http://localhost:3001                 │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│  第3步: 安装 Chrome 插件                                 │
│         chrome://extensions/ → 加载 chrome-extension    │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│  第4步: 配置插件 API Key                                 │
│         点击插件图标 → 设置 → 输入 Gemini API Key        │
└─────────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────────┐
│  第5步: 开始使用                                         │
│         1. 访问 Amazon 产品页                            │
│         2. 点击插件图标                                  │
│         3. 点击"开始分析"                                │
│         4. 查看 AI 分析报告                              │
└─────────────────────────────────────────────────────────┘
```

---

## 🎨 可选：使用 Web 界面

如果您想通过 Web 界面使用（适合演示或开发）：

### 1. 启动完整模式

```
START.bat → [2] 完整模式
```

### 2. 访问 Web 界面

浏览器打开：http://localhost:3002

### 3. 输入 ASIN 分析

1. 输入 Amazon 产品 ASIN（如：B07ZPKN6YR）
2. 点击「开始分析」
3. 等待分析完成
4. 查看报告

---

## 🛠️ 技术架构

```
┌────────────────────────────────────────────────────────┐
│              用户界面层                                 │
│  ┌─────────────────┐      ┌─────────────────┐         │
│  │  Chrome 插件     │      │  Web 界面        │         │
│  │  (主要方式)      │      │  (可选方式)      │         │
│  └─────────────────┘      └─────────────────┘         │
└────────────────────────────────────────────────────────┘
                       ↓
┌────────────────────────────────────────────────────────┐
│            后端 API 服务 (Express.js)                   │
│               http://localhost:3001                    │
└────────────────────────────────────────────────────────┘
         ↓                              ↓
┌──────────────────┐          ┌──────────────────┐
│  爬虫服务         │          │  AI 分析服务      │
│  - RapidAPI      │          │  - Gemini 2.5 Pro│
│  - Puppeteer     │          │  - 6 维度分析     │
└──────────────────┘          └──────────────────┘
```

---

## ❓ 常见问题

### Q1: 插件点击没反应？

**解决：**
1. 确认后端服务已启动（http://localhost:3001/api/health）
2. 检查插件是否已配置 Gemini API Key
3. 打开 Chrome 开发者工具（F12）查看错误信息

### Q2: 分析失败，提示 API Key 错误？

**解决：**
1. 检查插件设置中的 Gemini API Key 是否正确
2. 确认密钥有效且未过期
3. 尝试重新生成密钥

### Q3: 爬取评论失败？

**解决：**
1. 检查 `.env` 中的 `RAPIDAPI_KEY` 配置
2. 确认 RapidAPI 配额未用完（免费 500次/月）
3. 系统会自动降级到 Puppeteer 爬虫

### Q4: 如何查看后端日志？

后端服务窗口会实时显示日志：
```
[INFO] 收到分析请求，ASIN: B07ZPKN6YR
[INFO] 正在爬取评论...
[INFO] 爬取完成，共 150 条评论
[INFO] 开始 AI 分析...
[INFO] AI 分析完成，耗时: 35.2s
```

### Q5: 可以同时分析多个产品吗？

可以！后端支持并发请求，您可以打开多个 Amazon 产品页面，分别点击插件进行分析。

---

## 📊 系统性能

### 分析速度

- **评论爬取**: 10-30秒（取决于评论数量）
- **AI 分析**: 30-45秒（并发 7 个维度）
- **总耗时**: 约 40-75秒

### API 成本

基于测试数据（假设 $0.002/1K tokens）：

| 评论数量 | Token 使用 | 估算成本 |
|---------|-----------|---------|
| 3条     | ~22,000   | $0.04   |
| 50条    | ~80,000   | $0.16   |
| 100条   | ~150,000  | $0.30   |
| 500条   | ~700,000  | $1.40   |

---

## ⛔ 停止服务

双击运行：**`STOP-ALL.bat`**

自动停止所有运行中的服务。

---

## 📞 获取帮助

### 查看详细文档

- [项目技术方案](docs/01-项目技术方案总体设计.md)
- [Chrome 插件开发文档](docs/07-Chrome插件开发文档.md)
- [Gemini API 验证报告](GEMINI-API-VERIFICATION-REPORT.md)

### 运行健康检查

```bash
node scripts/health-check.js
```

### 运行测试

```bash
# 快速测试全量分析功能（推荐）
双击: TEST-FULL-ANALYSIS.bat

# 或手动运行测试
node tests/test-full-analysis.js

# 测试 Gemini API
node tests/test-gemini-api.js
```

---

## 🎉 开始使用

现在您可以：

1. ✅ 双击 **`START.bat`** 或 **`START-BACKEND.bat`**
2. ✅ 选择 **[1] 标准模式**（如使用START.bat）
3. ✅ 安装 **Chrome 插件**
4. ✅ 访问 **Amazon 产品页**
5. ✅ 点击插件 **开始分析**！

### 🧪 测试功能

测试全量分析功能：

```bash
# 方式1：双击运行（推荐）
TEST-FULL-ANALYSIS.bat

# 方式2：命令行运行
node tests/test-full-analysis.js
```

**测试内容：**
- ✅ 全量爬取评论（无数量限制）
- ✅ 深度消费者画像分析（性别比例、人群特征、使用场景）
- ✅ 百分比精确到小数点后2位

---

## 📦 可用的批处理文件

项目提供 **4个核心批处理文件**：

| 文件名 | 功能 | 使用场景 |
|--------|------|----------|
| **START.bat** | 主启动脚本（多模式选择） | 首次使用、需要Web界面 |
| **START-BACKEND.bat** | 快速启动后端 | 日常使用Chrome插件 ⭐ |
| **TEST-FULL-ANALYSIS.bat** | 测试全量分析功能 | 功能测试、验证配置 |
| **STOP-ALL.bat** | 停止所有服务 | 关闭系统 |

**详细说明：** 查看 [BAT-FILES-GUIDE.md](BAT-FILES-GUIDE.md)

---

**祝您使用愉快！** 🚀

